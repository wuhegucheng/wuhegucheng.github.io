{
    "version": "https://jsonfeed.org/version/1",
    "title": "今天也请继续加油 • All posts by \"元数据\" tag",
    "description": "",
    "home_page_url": "http://wuhegucheng.github.io",
    "items": [
        {
            "id": "http://wuhegucheng.github.io/2023/04/01/linux/base/06.%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7/02.%E7%B3%BB%E7%BB%9F%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6/",
            "url": "http://wuhegucheng.github.io/2023/04/01/linux/base/06.%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7/02.%E7%B3%BB%E7%BB%9F%E9%93%BE%E6%8E%A5%E6%96%87%E4%BB%B6/",
            "title": "系统链接文件",
            "date_published": "2023-04-01T08:46:15.000Z",
            "content_html": "<h1 id=\"系统链接文件\"><a class=\"markdownIt-Anchor\" href=\"#系统链接文件\">#</a> 系统链接文件</h1>\n<p>一个文件在 Linux 中，会被分为两部分：</p>\n<ul>\n<li>\n<p><strong>真实数据</strong>：文件中的真实内容</p>\n</li>\n<li>\n<p><strong>元数据</strong>：用来形容一个文件数据</p>\n</li>\n</ul>\n<p>一个文件在 Linux 中，存储也会被分为两部分：</p>\n<ul>\n<li>\n<p><strong>inode</strong>：用来存储，文件的元数据</p>\n</li>\n<li>\n<p><strong>block</strong>：用来存储，文件的真实数据，一个 block 是 <code>4kB</code></p>\n</li>\n</ul>\n<p><img data-src=\"https://roger-hub.oss-cn-shanghai.aliyuncs.com/img_sre/image-20220329142227873.png\" alt=\"image-20220329142227873\"></p>\n<p>查看磁盘空间  <code>df</code></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-h</td>\n<td style=\"text-align:center\"><code>human</code>  人类可读</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-i</td>\n<td style=\"text-align:center\">查看  <code>inode</code>  空间</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#语法</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">df</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#查看磁盘的 block </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># df -h </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Filesystem Size Used Avail Use% Mounted on </pre></td></tr><tr><td data-num=\"7\"></td><td><pre>/dev/sda3 19G <span class=\"token number\">1</span>.7G 17G <span class=\"token number\">9</span>% / </pre></td></tr><tr><td data-num=\"8\"></td><td><pre>devtmpfs 476M <span class=\"token number\">0</span> 476M <span class=\"token number\">0</span>% /dev </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>tmpfs 487M <span class=\"token number\">0</span> 487M <span class=\"token number\">0</span>% /dev/shm tmpfs 487M 39M 449M <span class=\"token number\">8</span>% /run </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>tmpfs 487M <span class=\"token number\">0</span> 487M <span class=\"token number\">0</span>% /sys/fs/cgroup </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>/dev/sda1 497M 120M 378M <span class=\"token number\">25</span>% /boot </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>tmpfs 98M <span class=\"token number\">0</span> 98M <span class=\"token number\">0</span>% /run/user/0 </pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#查看磁盘的 inode </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># df -hi </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>Filesystem Inodes IUsed IFree IUse% Mounted on </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>/dev/sda3 <span class=\"token number\">9</span>.3M 35K <span class=\"token number\">9</span>.3M <span class=\"token number\">1</span>% / </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>devtmpfs 119K <span class=\"token number\">377</span> 119K <span class=\"token number\">1</span>% /dev </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>tmpfs 122K <span class=\"token number\">1</span> 122K <span class=\"token number\">1</span>% /dev/shm </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>tmpfs 122K <span class=\"token number\">750</span> 121K <span class=\"token number\">1</span>% /run </pre></td></tr><tr><td data-num=\"21\"></td><td><pre>tmpfs 122K <span class=\"token number\">16</span> 122K <span class=\"token number\">1</span>% /sys/fs/cgroup </pre></td></tr><tr><td data-num=\"22\"></td><td><pre>/dev/sda1 250K <span class=\"token number\">326</span> 250K <span class=\"token number\">1</span>% /boot </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>tmpfs 122K <span class=\"token number\">1</span> 122K <span class=\"token number\">1</span>% /run/user/0</pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">#stat 查看文件详细信息</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># stat nginx-1.20.2-1.x86_64.rpm </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>  File: ‘nginx-1.20.2-1.x86_64.rpm’</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>  Size: <span class=\"token number\">2802126</span>   \tBlocks: <span class=\"token number\">5480</span>       IO Block: <span class=\"token number\">4096</span>   regular <span class=\"token function\">file</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>Device: fd00h/64768d\tInode: <span class=\"token number\">33575397</span>    Links: <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>Access: <span class=\"token punctuation\">(</span>0644/-rw-r--r--<span class=\"token punctuation\">)</span>  Uid: <span class=\"token punctuation\">(</span>    <span class=\"token number\">0</span>/    root<span class=\"token punctuation\">)</span>   Gid: <span class=\"token punctuation\">(</span>    <span class=\"token number\">0</span>/    root<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>Context: unconfined_u:object_r:admin_home_t:s0</pre></td></tr><tr><td data-num=\"32\"></td><td><pre>Access: <span class=\"token number\">2022</span>-04-30 <span class=\"token number\">14</span>:10:58.648933728 +0800</pre></td></tr><tr><td data-num=\"33\"></td><td><pre>Modify: <span class=\"token number\">2022</span>-04-30 <span class=\"token number\">14</span>:10:58.709933724 +0800</pre></td></tr><tr><td data-num=\"34\"></td><td><pre>Change: <span class=\"token number\">2022</span>-04-30 <span class=\"token number\">14</span>:10:58.709933724 +0800</pre></td></tr><tr><td data-num=\"35\"></td><td><pre> Birth: -</pre></td></tr></table></figure><p>执行 cat 的过程</p>\n<p><img data-src=\"https://roger-hub.oss-cn-shanghai.aliyuncs.com/img_sre/360%E6%88%AA%E5%9B%BE17100810463447.png\" alt=\"360截图17100810463447\"></p>\n<h2 id=\"链接文件的种类\"><a class=\"markdownIt-Anchor\" href=\"#链接文件的种类\">#</a> 链接文件的种类</h2>\n<ul>\n<li><strong>软链接文件</strong>\n<ul>\n<li>软链接相当于 windows 的快捷方式，软链接文件会将<strong> inode</strong> 指向源文件的<strong> block</strong></li>\n</ul>\n</li>\n</ul>\n<p><img data-src=\"https://roger-hub.oss-cn-shanghai.aliyuncs.com/img_sre/360%E6%88%AA%E5%9B%BE1710081010910195.png\" alt=\"360截图1710081010910195\"></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#创建软链接的命令 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>ln：link 链接，创建链接文件 </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>-s：soft 软，创建软链接文件 </pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#语法</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">ln</span> <span class=\"token parameter variable\">-s</span> 源文件 链接文件的位置</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#示例</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">## 不指定文件，产生同名链接</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln -s /root/1.txt /tmp/ </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ll /tmp/</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>total <span class=\"token number\">196</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">11</span> Mar <span class=\"token number\">29</span> <span class=\"token number\">10</span>:54 <span class=\"token number\">1</span>.txt -<span class=\"token operator\">></span> /root/1.txt</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">## 指定文件</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln -s /root/1.txt /tmp/2.txt </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ll /tmp/ </span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>total <span class=\"token number\">196</span> </pre></td></tr><tr><td data-num=\"18\"></td><td><pre>lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">11</span> Mar <span class=\"token number\">29</span> <span class=\"token number\">10</span>:54 <span class=\"token number\">1</span>.txt -<span class=\"token operator\">></span> /root/1.txt </pre></td></tr><tr><td data-num=\"19\"></td><td><pre>lrwxrwxrwx <span class=\"token number\">1</span> root root <span class=\"token number\">11</span> Mar <span class=\"token number\">29</span> <span class=\"token number\">10</span>:55 <span class=\"token number\">2</span>.txt -<span class=\"token operator\">></span> /root/1.txt</pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>ps:多个软链接指向同一个block，不占多余空间</pre></td></tr><tr><td data-num=\"22\"></td><td><pre>   软链接文件，会受到源文件的影响，如果源文件删除，软链接文件也无法使用</pre></td></tr><tr><td data-num=\"23\"></td><td><pre>   </pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#软链接的应用场景</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token number\">1</span>.软件升级</pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">2</span>.代码发布</pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">3</span>.不方便移动的目录</pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">4</span>.数据回滚</pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">5</span>.程序读取</pre></td></tr></table></figure><p><strong>硬链接文件</strong></p>\n<ul>\n<li>若一个<strong> inode</strong> 对应多个文件名，则称这些文件为硬链接。换句话说，硬链接就是同一个文件使用了多个别名</li>\n</ul>\n<p><img data-src=\"https://roger-hub.oss-cn-shanghai.aliyuncs.com/img_sre/360%E6%88%AA%E5%9B%BE175711199510386.png\" alt=\"360截图175711199510386\"></p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#语法</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">ln</span> 源文件 链接文件的位置</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#示例</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln /root/info.txt /opt/ </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln /root/info.txt /opt/info_1.txt</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#查看文件属性</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li /root/info.txt </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">33575833</span> -rw-r--r-- <span class=\"token number\">3</span> root root <span class=\"token number\">72</span> Mar <span class=\"token number\">25</span> <span class=\"token number\">11</span>:09 /root/info.txt </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li /opt/info.txt </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">33575833</span> -rw-r--r-- <span class=\"token number\">3</span> root root <span class=\"token number\">72</span> Mar <span class=\"token number\">25</span> <span class=\"token number\">11</span>:09 /opt/info.txt </pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -li /opt/info_1.txt </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token number\">33575833</span> -rw-r--r-- <span class=\"token number\">3</span> root root <span class=\"token number\">72</span> Mar <span class=\"token number\">25</span> <span class=\"token number\">11</span>:09 /opt/info1.txt</pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#查看文件内容 </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /root/info.txt </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>I<span class=\"token string\">'m zzgx,\"18'</span>years old QQ <span class=\"token number\">133411023</span> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre>I<span class=\"token string\">'m wyk,\"103'</span>years old QQ <span class=\"token number\">383838384</span> </pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /opt/info.txt </span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>I<span class=\"token string\">'m zzgx,\"18'</span>years old QQ <span class=\"token number\">133411023</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre>I<span class=\"token string\">'m wyk,\"103'</span>years old QQ <span class=\"token number\">383838384</span> </pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /opt/info_1.txt </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>I<span class=\"token string\">'m zzgx,\"18'</span>years old QQ <span class=\"token number\">133411023</span> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre>I<span class=\"token string\">'m wyk,\"103'</span>years old QQ <span class=\"token number\">383838384</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">#特性 </span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token number\">1</span>.硬链接文件，不会受到原文件的影响 </pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token number\">2</span>.所有硬链接文件的inode号与源文件相同 </pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">3</span>.修改一个文件，其他文件都会改变 </pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token number\">4</span>.不允许给目录创建硬链接 </pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token number\">5</span>.默认情况下，新创建的目录，有两个硬链接，一个是目录本身，一个是该目录下的.目录</pre></td></tr><tr><td data-num=\"31\"></td><td><pre></pre></td></tr><tr><td data-num=\"32\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -lai /root/test -d </span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token number\">33575836</span> drwxr-xr-x <span class=\"token number\">2</span> root root <span class=\"token number\">6</span> Mar <span class=\"token number\">29</span> <span class=\"token number\">11</span>:52 /root/test </pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ls -lai /root/test </span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>total <span class=\"token number\">4</span> </pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token number\">33575836</span> drwxr-xr-x <span class=\"token number\">2</span> root root <span class=\"token number\">6</span> Mar <span class=\"token number\">29</span> <span class=\"token number\">11</span>:52 <span class=\"token builtin class-name\">.</span> </pre></td></tr><tr><td data-num=\"37\"></td><td><pre></pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token comment\">#报错 </span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost opt<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln /root/wyk /tmp/wyk </span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>ln: ‘/root/wyk’: hard <span class=\"token function\">link</span> not allowed <span class=\"token keyword\">for</span> directory</pre></td></tr></table></figure><h2 id=\"软链接使用场景实践\"><a class=\"markdownIt-Anchor\" href=\"#软链接使用场景实践\">#</a> 软链接使用场景实践</h2>\n<blockquote>\n<p>Q：软链接使用场景</p>\n<ul>\n<li>软件升级</li>\n<li>代码发布</li>\n</ul>\n</blockquote>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#1. 准备网站 1.1 版本代码</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir\t/data/rainbow-v1.1 -p</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo \"123\" > /data/rainbow-v1.1/index.html</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#2. 创建软链接</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln -s /data/rainbow-v1.1/ /data/rainbow</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ll /data/</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>drwxr-xr-x.\t<span class=\"token number\">2</span> root root <span class=\"token number\">6</span> <span class=\"token number\">3</span>์ <span class=\"token number\">5</span> <span class=\"token number\">12</span>:23 <span class=\"token function\">dir</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>lrwxrwxrwx.\t<span class=\"token number\">1</span> root root\t<span class=\"token number\">19</span> <span class=\"token number\">3</span>์ <span class=\"token number\">10</span> <span class=\"token number\">12</span>:09 rainbow -<span class=\"token operator\">></span> /data/rainbow-v1.1/</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>drwxr-xr-x.\t<span class=\"token number\">2</span> root root\t<span class=\"token number\">24</span> <span class=\"token number\">3</span>์ <span class=\"token number\">10</span> <span class=\"token number\">12</span>:09 rainbow-v1.1</pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#3. 检查网站程序</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /data/rainbow/index.html</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token number\">123</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#4. 新更新一个网站的程序代码</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /data/rainbow-v1.2</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo \"456\" > /data/rainbow-v1.2/index.html</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#5. 升级</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># rm -f\t/data/rainbow &amp;&amp; ln\t-s /data/rainbow-v1.2/ /data/rainbow</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /data/rainbow/index.html</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token number\">456</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token comment\">#6. 回退</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># rm -f /data/rainbow &amp;&amp; ln -s /data/rainbow-v1.1/ /data/rainbow</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /data/rainbow/index.html</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre><span class=\"token number\">123</span></pre></td></tr></table></figure><h2 id=\"硬链接与软链接的区别\"><a class=\"markdownIt-Anchor\" href=\"#硬链接与软链接的区别\">#</a> 硬链接与软链接的区别</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">区别</th>\n<th style=\"text-align:center\">硬链接</th>\n<th style=\"text-align:center\">软链接</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">创建命令</td>\n<td style=\"text-align:center\">ln</td>\n<td style=\"text-align:center\">ln -s</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">对象</td>\n<td style=\"text-align:center\">只能对普通文件创建</td>\n<td style=\"text-align:center\">普通文件和目录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">是否收到源文件影响</td>\n<td style=\"text-align:center\">否</td>\n<td style=\"text-align:center\">是</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">inode 号</td>\n<td style=\"text-align:center\">相同</td>\n<td style=\"text-align:center\">不同</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">跨分区创建</td>\n<td style=\"text-align:center\">不可以</td>\n<td style=\"text-align:center\">可以</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"企业面试题\"><a class=\"markdownIt-Anchor\" href=\"#企业面试题\">#</a> 企业面试题</h2>\n<p>当前磁盘空间还剩余 500G，但是就无法往里面写入数据，报错，磁盘空间满了</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#1. 首先磁盘存储被划分为两块 inode：存储文件的元数据 block：存储文件的真实数据 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#2. 在问题当中剩余 500G，这 500G 指的是 block </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#3. 应该是 inode 被占满了 </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#4. 这种情况，一般是系统中，小文件太多导致的</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#5. 使用 find 命令找到系统中的小文件（没用的），并删除</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">#示例</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#从 /dev/zero 中取出 1024k 数据，保存到 /opt/disk 文件中</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># dd if=/dev/zero of=/opt/bigdata bs=1K count=1024</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token comment\">#格式化，指定 inode</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkfs.ext4 -i 1024 /opt/bigdata</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#在 / 下创建一个目录 inode</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /inode</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#把刚才的分区，挂载到 /data1 下</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mount -t ext4 -o loop /opt/bigdata /inode</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#查看新分区 inode 大小</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">[</span>root@www ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># df -ih</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#演示 inode 被沾满</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token punctuation\">[</span>root@www data1<span class=\"token punctuation\">]</span><span class=\"token comment\"># touch &#123;1001..1014&#125;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">[</span>root@www data1<span class=\"token punctuation\">]</span><span class=\"token comment\"># touch www</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>touch: cannot <span class=\"token function\">touch</span> ‘zls’: No space left on device</pre></td></tr></table></figure>",
            "tags": [
                "block",
                "inode",
                "软链接",
                "元数据"
            ]
        }
    ]
}