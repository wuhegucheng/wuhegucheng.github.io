{
    "version": "https://jsonfeed.org/version/1",
    "title": "今天也请继续加油 • All posts by \"用户\" tag",
    "description": "",
    "home_page_url": "http://wuhegucheng.github.io",
    "items": [
        {
            "id": "http://wuhegucheng.github.io/2023/04/01/linux/base/08.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/01.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%861/",
            "url": "http://wuhegucheng.github.io/2023/04/01/linux/base/08.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/01.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%861/",
            "title": "用户管理",
            "date_published": "2023-04-01T08:46:15.000Z",
            "content_html": "<h1 id=\"用户管理\"><a class=\"markdownIt-Anchor\" href=\"#用户管理\">#</a> 用户管理</h1>\n<h2 id=\"linux中用户的概述\"><a class=\"markdownIt-Anchor\" href=\"#linux中用户的概述\">#</a> Linux 中用户的概述</h2>\n<p>用户指的是能够正常登录 Linux 或 windows 系统</p>\n<p>与 windows 用户的区别：</p>\n<ul>\n<li>\n<p>支持同一个用户多个设备同时登录</p>\n</li>\n<li>\n<p>支持不同的用户多个设备同时登录</p>\n</li>\n</ul>\n<p>用户的作用</p>\n<p>1）系统上的每一个进程 (运行的程序) 都需要特定的用户运行</p>\n<p>2）每一个文件都有特定的用户拥有，所以访问一个文件或目录受到用户的限制</p>\n<p>3）进程能够以何种方式访问某一个文件或目录，与进程所关联的用户有关</p>\n<h2 id=\"查看系统中用户的命令\"><a class=\"markdownIt-Anchor\" href=\"#查看系统中用户的命令\">#</a> 查看系统中用户的命令</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-u</td>\n<td style=\"text-align:center\">查看当前登录用户的 uid</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-g</td>\n<td style=\"text-align:center\">查看当前登录用户的 gid</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-n</td>\n<td style=\"text-align:center\">配合 - u 或者 - g 一起使用<br/>配合 - u：查看当前登录用户 uid 对应的名字<br>配合 - g：查看当前登录用户 gid 对应的名字</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#查看指定用户的信息 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>id：默认情况不加用户名则查看当前登录用户的信息 </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token comment\">#语法</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">id</span> <span class=\"token punctuation\">[</span>用户名<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># id python</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token assign-left variable\">uid</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>python<span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">gid</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>python<span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">groups</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>python<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\">uid</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>zls<span class=\"token punctuation\">)</span>     <span class=\"token comment\">#UserID: 用户 id 号 </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token assign-left variable\">gid</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>zls<span class=\"token punctuation\">)</span>     <span class=\"token comment\">#GroupID：用户组 id 号 </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token assign-left variable\">groups</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>zls<span class=\"token punctuation\">)</span>  <span class=\"token comment\">#该用户的所有组信息</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>ps:id不加任何参数查看的是当前登录用户</pre></td></tr></table></figure><p>后台进程查看</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># ps -ef | less</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token environment constant\">UID</span>         PID   <span class=\"token environment constant\">PPID</span>  C STIME TTY          TIME CMD</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root          <span class=\"token number\">1</span>      <span class=\"token number\">0</span>  <span class=\"token number\">0</span> Apr01 ?        00:00:02 /usr/lib/systemd/systemd --switched-root <span class=\"token parameter variable\">--system</span> <span class=\"token parameter variable\">--deserialize</span> <span class=\"token number\">22</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>root          <span class=\"token number\">2</span>      <span class=\"token number\">0</span>  <span class=\"token number\">0</span> Apr01 ?        00:00:00 <span class=\"token punctuation\">[</span>kthreadd<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>root          <span class=\"token number\">3</span>      <span class=\"token number\">2</span>  <span class=\"token number\">0</span> Apr01 ?        00:00:00 <span class=\"token punctuation\">[</span>ksoftirqd/0<span class=\"token punctuation\">]</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>root          <span class=\"token number\">5</span>      <span class=\"token number\">2</span>  <span class=\"token number\">0</span> Apr01 ?        00:00:00 <span class=\"token punctuation\">[</span>kworker/0:0H<span class=\"token punctuation\">]</span></pre></td></tr></table></figure><h2 id=\"系统用户相关的配置文件\"><a class=\"markdownIt-Anchor\" href=\"#系统用户相关的配置文件\">#</a> 系统用户相关的配置文件</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>/etc/passwd   <span class=\"token comment\">#用户信息配置文件 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>/etc/shadow   <span class=\"token comment\">#用户密码存储文件 </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>/etc/group    <span class=\"token comment\">#用户组信息配置文件 </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>/etc/gshadow  <span class=\"token comment\">#用户组密码存储文件</span></pre></td></tr></table></figure><p>/etc/passwd</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/passwd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#文件内容 </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root:x:0:0:root:/root:/bin/bash </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>dbus:x:81:81:System message bus:/:/sbin/nologin</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>/bin/bash：交由bash执行</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>/sbin/nologin：不允许用户登录</pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">第一列</th>\n<th style=\"text-align:center\">第二列</th>\n<th style=\"text-align:center\">第三列</th>\n<th style=\"text-align:center\">第四列</th>\n<th style=\"text-align:center\">第五列</th>\n<th style=\"text-align:center\">第六列</th>\n<th style=\"text-align:center\">第七列</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">内容</td>\n<td style=\"text-align:center\">dbus</td>\n<td style=\"text-align:center\">x</td>\n<td style=\"text-align:center\">81</td>\n<td style=\"text-align:center\">81</td>\n<td style=\"text-align:center\">System message bus</td>\n<td style=\"text-align:center\">/</td>\n<td style=\"text-align:center\">/sbin/nologin</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">作用</td>\n<td style=\"text-align:center\">用户名</td>\n<td style=\"text-align:center\">密码占位符</td>\n<td style=\"text-align:center\">UID</td>\n<td style=\"text-align:center\">GID</td>\n<td style=\"text-align:center\">用户描述信息</td>\n<td style=\"text-align:center\">用户家目录</td>\n<td style=\"text-align:center\">用户登录的 shell</td>\n</tr>\n</tbody>\n</table>\n<p><img data-src=\"https://roger-hub.oss-cn-shanghai.aliyuncs.com/img_sre/image-20220402071657752.png\" alt=\"image-20220402071657752\"></p>\n<p>/etc/shadow</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/shadow</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\">#文件内容</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root:<span class=\"token variable\">$6</span><span class=\"token variable\">$YOE1El8va0a</span>/N13b<span class=\"token variable\">$E5HM</span>/7RVJu4rY.Kbfp9iC2msOras3rWKzOzWZqmjnVBsFswaZXhz.TCrlbffyavK8nG61.19xOLJBoVrnb7Zb0::0:99999:7:::</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>bin:*:17834:0:99999:7:::</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>daemon:*:17834:0:99999:7:::</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>adm:*:17834:0:99999:7:::</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>*、<span class=\"token operator\">!</span><span class=\"token operator\">!</span>：表示没有密码</pre></td></tr></table></figure><table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">第一列</th>\n<th style=\"text-align:center\">第二列</th>\n<th style=\"text-align:center\">第三列</th>\n<th style=\"text-align:center\">第四列</th>\n<th style=\"text-align:center\">第五列</th>\n<th style=\"text-align:center\">第六列</th>\n<th style=\"text-align:center\">第七列</th>\n<th style=\"text-align:center\">第八列</th>\n<th style=\"text-align:center\">第九列</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">内容</td>\n<td style=\"text-align:center\">bin</td>\n<td style=\"text-align:center\">*</td>\n<td style=\"text-align:center\">17834</td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">99999</td>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">6627567</td>\n<td style=\"text-align:center\">空</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">作用</td>\n<td style=\"text-align:center\">用户名</td>\n<td style=\"text-align:center\">密码（加密）</td>\n<td style=\"text-align:center\">上一次修改密码从 1970 年到现在过了多少天</td>\n<td style=\"text-align:center\">密码最少使用多少天，0 代表没有限制</td>\n<td style=\"text-align:center\">密码最多使用多少天</td>\n<td style=\"text-align:center\">密码快过期前 7 天，提示修改密码</td>\n<td style=\"text-align:center\">密码过期后 2 两天强制修改密码</td>\n<td style=\"text-align:center\">账户失效时间</td>\n<td style=\"text-align:center\">保留</td>\n</tr>\n</tbody>\n</table>\n<p><img data-src=\"https://roger-hub.oss-cn-shanghai.aliyuncs.com/img_sre/image-20220402071741563.png\" alt=\"image-20220402071741563\"></p>\n<h2 id=\"用户分类约定-规范centos7\"><a class=\"markdownIt-Anchor\" href=\"#用户分类约定-规范centos7\">#</a> 用户分类（约定、规范 CentOS7）</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">用户 UID</th>\n<th style=\"text-align:center\">系统中含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">超级管理员用户</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">1-200</td>\n<td style=\"text-align:center\">系统用户（系统自己创建的）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">201-999</td>\n<td style=\"text-align:center\">系统用户（可以手动创建）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">1000+</td>\n<td style=\"text-align:center\">普通用户</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"chage命令修改用户信息了解\"><a class=\"markdownIt-Anchor\" href=\"#chage命令修改用户信息了解\">#</a> chage 命令修改用户信息（了解）</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token parameter variable\">-d</span>  <span class=\"token comment\">#设置最近一次更改密码时间，0 下次登陆系统强制修改密码 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token parameter variable\">-m</span>  <span class=\"token comment\">#设置用户两次改变密码之间使用 \"最小天数\"</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token parameter variable\">-M</span>  <span class=\"token comment\">#设置用户两次改变密码之间使用 \"最大天数\" </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token parameter variable\">-W</span>  <span class=\"token comment\">#设置密码更改警告时间 将过期警告天数设为 “警告天数” </span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token parameter variable\">-I</span>  <span class=\"token comment\">#设置密码过期天数后，密码为失效状态 </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token parameter variable\">-E</span>  <span class=\"token comment\">#设置用户过期时间，账户失效后无法登陆 </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token parameter variable\">-l</span>  <span class=\"token comment\">#显示用户信息</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#修改时间为 2014 年 08 月 31 日，和图中时间匹配，方便后续验证 </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># date -s '20140831' </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>Sun Aug <span class=\"token number\">31</span> 00:00:00 CST <span class=\"token number\">2014</span> </pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># date </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>Sun Aug <span class=\"token number\">31</span> 00:00:01 CST <span class=\"token number\">2014</span> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd zls1 </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo \"123\" |passwd --stdin zls1 </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -1 /etc/shadow </span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16312:0:99999:7::: </pre></td></tr><tr><td data-num=\"18\"></td><td><pre></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">#设置最近一次修改密码时间 </span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -d \"2014-09-01\" zls1 </span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16314:0:99999:7::: </pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#设置最短使用密码时间 </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -m 2 zls1 </span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow </span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16314:2:99999:7::: </pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">#设置密码最长使用时间 </span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -M 15 zls1 </span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow </span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16314:2:15:7::: </pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre><span class=\"token comment\">#设置密码警告时间 </span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -W 6 zls1 </span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16314:2:15:6::: </pre></td></tr><tr><td data-num=\"38\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -W 7 zls1 </span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow zls1:!!:16314:2:15:7::: </span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre></pre></td></tr><tr><td data-num=\"41\"></td><td><pre><span class=\"token comment\">#设置密码过期时间 </span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -I 5 zls1 </span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow </span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16314:2:15:6:5:: </pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre><span class=\"token comment\">#设置用户过期时间 </span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -E \"20115-08-31\" zls1 </span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># tail -n1 /etc/shadow </span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>zls1:<span class=\"token operator\">!</span><span class=\"token operator\">!</span>:16314:2:15:6:5:6627567: </pre></td></tr><tr><td data-num=\"50\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># chage -l zls1 </span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>Last password change <span class=\"token builtin class-name\">:</span> Sep 01, <span class=\"token number\">2014</span>  <span class=\"token comment\">#最近一次更改密码时间</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>Password expires <span class=\"token builtin class-name\">:</span> Sep <span class=\"token number\">16</span>, <span class=\"token number\">2014</span>  <span class=\"token comment\">#密码过期时间 </span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>Password inactive <span class=\"token builtin class-name\">:</span> Sep <span class=\"token number\">21</span>, <span class=\"token number\">2014</span>  <span class=\"token comment\">#密码失效时间 </span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>Account expires <span class=\"token builtin class-name\">:</span> Aug <span class=\"token number\">31</span>, <span class=\"token number\">2015</span>  <span class=\"token comment\">#用户失效时间 </span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre>Minimum number of days between password change <span class=\"token builtin class-name\">:</span> <span class=\"token number\">2</span>  <span class=\"token comment\">#密码最短使用时间 </span></pre></td></tr><tr><td data-num=\"56\"></td><td><pre>Maximum number of days between password change <span class=\"token builtin class-name\">:</span> <span class=\"token number\">15</span>  <span class=\"token comment\">#密码最长使用时间 </span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>Number of days of warning before password expires <span class=\"token builtin class-name\">:</span> <span class=\"token number\">7</span>  <span class=\"token comment\">#密码过期前警告天数</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre></pre></td></tr><tr><td data-num=\"59\"></td><td><pre><span class=\"token comment\">#如何验证，只调整时间为如下进行验证: </span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre><span class=\"token number\">1</span>.验证普通用户是否能修改密码, 不需要调整时间。 </pre></td></tr><tr><td data-num=\"61\"></td><td><pre><span class=\"token number\">2</span>.普通用户登陆系统后, 会提示警告密码还剩多少天过期 </pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># date -s \"2014-09-12\" </span></pre></td></tr><tr><td data-num=\"63\"></td><td><pre><span class=\"token number\">3</span>.普通用户登陆系统后, 强制要求修改密码 </pre></td></tr><tr><td data-num=\"64\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># date -s \"2014-09-18\" </span></pre></td></tr><tr><td data-num=\"65\"></td><td><pre><span class=\"token number\">4</span>.普通用户登陆系统后, 提示账户已过期 </pre></td></tr><tr><td data-num=\"66\"></td><td><pre><span class=\"token punctuation\">[</span>root@zls ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># date -s \"2014-09-23\"</span></pre></td></tr></table></figure><h2 id=\"用户操作命令\"><a class=\"markdownIt-Anchor\" href=\"#用户操作命令\">#</a> 用户操作命令</h2>\n<p><strong>用户创建</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-u</td>\n<td style=\"text-align:center\">创建用户时指定用户的 uid</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-g</td>\n<td style=\"text-align:center\">创建用户时指定用户的 gid 指定用户组名（该组必须存在）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-G</td>\n<td style=\"text-align:center\">创建用户时指定用户的附加组（该组必须存在）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-c</td>\n<td style=\"text-align:center\">创建用户时指定用户的描述信息</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-d</td>\n<td style=\"text-align:center\">创建用户时指定用户的家目录（该目录可以不存在，会自动创建）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-M</td>\n<td style=\"text-align:center\">创建用户时不创建用户的家目录</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-s</td>\n<td style=\"text-align:center\">创建用户时指定用户登录的 shell（默认是 /bin/bash）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-r</td>\n<td style=\"text-align:center\">创建用户时指定用户为系统用户</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">useradd</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ps:创建用户在默认不指定组的情况下，会同时创建出跟该用户名相同的组，跟uid相同的gid，除非-g指定组，则 不会创建同名组</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#语法</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">useradd</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> 用户名</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#示例</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user01 </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user02 -u 503              #创建用户 usr02，指定 uid </span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user03 -d /aaa             #创建用户 user03 指定家目录</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user04 -M                  #创建用户 user04，不创建家目录 </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user05 -s /sbin/nologin    #创建用户并指定 shell </span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user06 -g hr               #创建用户，指定主组 </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user07 -G sale             #创建用户，指定附加组 </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd user08 -e 2014-04-01       #指定过期时间 </span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd xxx -M -s /sbin/nologin    #创建普通用户，但是没有家目录，不能登录系统 </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd -r yyy -s /sbin/nologin    #yyy 属于系统用户，uid 处于系统用户 uid 范围内</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token parameter variable\">-M</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>启动程序不需要家目录，容易被黑客攻击</pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#报错 1 </span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd zls1 -u 666 -g 666 </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>useradd: group <span class=\"token string\">'666'</span> does not exist </pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>原因：666这个组不存在，前提，-g必须加入到一个已存在的组</pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre><span class=\"token comment\">#报错 2 </span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /dsb </span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd hl1 -d /dsb/ </span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>useradd: warning: the home directory already exists. Not copying any <span class=\"token function\">file</span> from skel directory into it. </pre></td></tr><tr><td data-num=\"33\"></td><td><pre></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>原因：使用-d指定用户的家目录时，家目录不能提前创建</pre></td></tr></table></figure><p><strong>修改用户</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-u</td>\n<td style=\"text-align:center\">修改用户时指定用户的 uid</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-g</td>\n<td style=\"text-align:center\">修改用户时指定用户的 gid 指定用户组名（该组必须存在）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-G</td>\n<td style=\"text-align:center\">修改用户时指定用户的附加组，会覆盖原来的附加组（该组必须存在）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-a</td>\n<td style=\"text-align:center\">修改用户附加组的时候，配合 - a 追加使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-c</td>\n<td style=\"text-align:center\">修改用户时指定用户的描述信息</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-d</td>\n<td style=\"text-align:center\">修改用户时指定用户的家目录（该目录可以不存在，会自动创建）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-m</td>\n<td style=\"text-align:center\">修改用户时迁移用户的家目录，必须配合 - d 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-s</td>\n<td style=\"text-align:center\">修改用户时指定用户登录的 shell（默认是 /bin/bash）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-l</td>\n<td style=\"text-align:center\">更改用户登录名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-L</td>\n<td style=\"text-align:center\">锁定用户</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-U</td>\n<td style=\"text-align:center\">解锁用户</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">usermod</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#语法 </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">usermod</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> 用户名</pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#示例</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># usermod -e 2013-02-11 user1000  #修改过期时间 </span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># usermod -g group1 jj            #修改主组 </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># usermod -a -G group2 jj         #修改附加组，-a 添加，不加 - a 代表覆盖</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#报错 [root@localhost ~]# usermod hl3 -l hl38 </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>usermod: user hl3 is currently used by process <span class=\"token number\">70107</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>原因：hl3用户当前正在被PID为70107进程占用，所以无法修改</pre></td></tr></table></figure><p><strong>删除用户</strong></p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">选项</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">-r</td>\n<td style=\"text-align:center\">递归删除，用户所有相关文件</td>\n</tr>\n</tbody>\n</table>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">userdel</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>ps:删除用户，默认情况下，只删除用户本身，其他相关目录文件不会删除</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token comment\">#语法 </span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token function\">userdel</span> <span class=\"token punctuation\">[</span>options<span class=\"token punctuation\">]</span> 用户名</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#示例</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@root ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># userdel -r python</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#警告 </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># useradd test </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>useradd: warning: the home directory already exists. Not copying any <span class=\"token function\">file</span> from skel directory into it. Creating mailbox file: File exists </pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>原因：创建用户时，该用户以前创建过，但是在删除时没有加-r选项，没有删干净（用户同样可以创建出来）</pre></td></tr></table></figure><h2 id=\"查看用户其他命令\"><a class=\"markdownIt-Anchor\" href=\"#查看用户其他命令\">#</a> 查看用户其他命令</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">#查看当前系统登录了哪些用户 </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># who</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>当前登录用户    终端      登录时间      从哪个IP登录 </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>   root      pts/0\t  <span class=\"token number\">2022</span>-04-01  <span class=\"token number\">11</span>:00 <span class=\"token punctuation\">(</span><span class=\"token number\">10.0</span>.0.1<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#查看当前系统登录了哪些用户 </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># w</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>当前系统时间  服务器总共运行时间  登录用户数  系统的平均负载 </pre></td></tr><tr><td data-num=\"9\"></td><td><pre>08:52:18 up <span class=\"token number\">15</span> days, <span class=\"token number\">2</span>:03, <span class=\"token number\">4</span> users, load average: <span class=\"token number\">0.00</span>, <span class=\"token number\">0.01</span>, <span class=\"token number\">0.05</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token environment constant\">USER</span> TTY FROM LOGIN@ IDLE JCPU PCPU WHAT </pre></td></tr><tr><td data-num=\"11\"></td><td><pre>root pts/0 <span class=\"token number\">10.0</span>.0.1 Fri11 <span class=\"token number\">2</span>.00s <span class=\"token number\">1</span>.59s <span class=\"token number\">0</span>.00s w </pre></td></tr><tr><td data-num=\"12\"></td><td><pre>root pts/1 <span class=\"token number\">10.0</span>.0.1 23Mar22 3days <span class=\"token number\">0</span>.54s <span class=\"token number\">0</span>.54s <span class=\"token parameter variable\">-bash</span> </pre></td></tr><tr><td data-num=\"13\"></td><td><pre>root pts/2 <span class=\"token number\">10.0</span>.0.1 21Mar22 12days <span class=\"token number\">0</span>.04s <span class=\"token number\">0</span>.04s <span class=\"token parameter variable\">-bash</span> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre>root pts/3 <span class=\"token number\">10.0</span>.0.1 23Mar22 12days <span class=\"token number\">0</span>.06s <span class=\"token number\">0</span>.06s <span class=\"token parameter variable\">-bash</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre><span class=\"token comment\">#查看当前登录的用户 </span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># whoami</span></pre></td></tr></table></figure>",
            "tags": [
                "用户"
            ]
        },
        {
            "id": "http://wuhegucheng.github.io/2023/04/01/linux/base/08.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/02.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%862/",
            "url": "http://wuhegucheng.github.io/2023/04/01/linux/base/08.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/02.%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%862/",
            "title": "用户管理1",
            "date_published": "2023-04-01T08:46:15.000Z",
            "content_html": "<h1 id=\"用户管理\"><a class=\"markdownIt-Anchor\" href=\"#用户管理\">#</a> 用户管理</h1>\n<h2 id=\"创建用户流程\"><a class=\"markdownIt-Anchor\" href=\"#创建用户流程\">#</a> 创建用户流程</h2>\n<h4 id=\"etclogindefs\"><a class=\"markdownIt-Anchor\" href=\"#etclogindefs\">#</a> /etc/login.defs</h4>\n<figure class=\"highlight python\"><figcaption data-lang=\"python\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span><span class=\"token comment\"># grep -Ev '^#|^$' /etc/login.defs</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost <span class=\"token operator\">~</span><span class=\"token punctuation\">]</span><span class=\"token comment\"># grep -i '^[a-z]' /etc/login.defs </span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#指定创建用户时，默认邮件文件位置 </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>MAIL_DIR <span class=\"token operator\">/</span>var<span class=\"token operator\">/</span>spool<span class=\"token operator\">/</span>mail </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token comment\">#创建用户默认密码最大使用天数 </span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>PASS_MAX_DAYS <span class=\"token number\">99999</span> </pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#创建用户默认密码最小使用天数（0 代表无限） </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>PASS_MIN_DAYS <span class=\"token number\">0</span> </pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token comment\">#密码最短位数 </span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>PASS_MIN_LEN <span class=\"token number\">5</span> </pre></td></tr><tr><td data-num=\"14\"></td><td><pre></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token comment\">#密码过期警告 </span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>PASS_WARN_AGE <span class=\"token number\">7</span> </pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#普通用户，最小 UID 是 1000 </span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>UID_MIN <span class=\"token number\">1000</span> </pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#普通用户，最大 UID 是 60000 </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>UID_MAX <span class=\"token number\">60000</span> </pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token comment\">#系统用户，最小 UID 是 201 </span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>SYS_UID_MIN <span class=\"token number\">201</span> </pre></td></tr><tr><td data-num=\"26\"></td><td><pre></pre></td></tr><tr><td data-num=\"27\"></td><td><pre><span class=\"token comment\">#系统用户，最大 UID 是 999 </span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>SYS_UID_MAX <span class=\"token number\">999</span> </pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre><span class=\"token comment\">#普通用户组，最小 GID 是 1000</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>GID_MIN <span class=\"token number\">1000</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre></pre></td></tr><tr><td data-num=\"33\"></td><td><pre><span class=\"token comment\">#普通用户组，最大 GID 是 60000 </span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>GID_MAX <span class=\"token number\">60000</span> </pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre><span class=\"token comment\">#系统用户组，最小 GID 是 201 </span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>SYS_GID_MIN <span class=\"token number\">201</span> </pre></td></tr><tr><td data-num=\"38\"></td><td><pre></pre></td></tr><tr><td data-num=\"39\"></td><td><pre><span class=\"token comment\">#系统用户组，最大 GID 是 999 </span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>SYS_GID_MAX <span class=\"token number\">999</span> </pre></td></tr><tr><td data-num=\"41\"></td><td><pre></pre></td></tr><tr><td data-num=\"42\"></td><td><pre><span class=\"token comment\">#默认创建用户的家目录 </span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>CREATE_HOME yes </pre></td></tr><tr><td data-num=\"44\"></td><td><pre></pre></td></tr><tr><td data-num=\"45\"></td><td><pre><span class=\"token comment\">#UMASK 077 指定用户创建家目录的默认权限 </span></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>UMASK <span class=\"token number\">077</span> </pre></td></tr><tr><td data-num=\"47\"></td><td><pre></pre></td></tr><tr><td data-num=\"48\"></td><td><pre><span class=\"token comment\">#创建用户时，如果不用 - g 指定组，那么会默认创建出该用户的同名组 </span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>USERGROUPS_ENAB yes </pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre><span class=\"token comment\">#用户密码的加密方式 </span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>SHA512 ENCRYPT_METHOD SHA512</pre></td></tr></table></figure><h4 id=\"权限了解\"><a class=\"markdownIt-Anchor\" href=\"#权限了解\">#</a> 权限了解</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>r：读权限 <span class=\"token number\">4</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>w：写权限 <span class=\"token number\">2</span> </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>x：执行权限 <span class=\"token number\">1</span> </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>-：没有权限 <span class=\"token number\">0</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre>目录创建默认权限：0777 - <span class=\"token builtin class-name\">umask</span> </pre></td></tr><tr><td data-num=\"6\"></td><td><pre>文件创建默认权限：0666 - <span class=\"token builtin class-name\">umask</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#如果当前用户的 UID>199 并且 UID=GID, 权限是 umask 002 否则权限是 umask 022</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token keyword\">if</span> <span class=\"token punctuation\">[</span> <span class=\"token environment constant\">$UID</span> <span class=\"token parameter variable\">-gt</span> <span class=\"token number\">199</span> <span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">`</span>/usr/bin/id <span class=\"token parameter variable\">-gn</span><span class=\"token variable\">`</span></span>\"</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"<span class=\"token variable\"><span class=\"token variable\">`</span>/usr/bin/id <span class=\"token parameter variable\">-un</span><span class=\"token variable\">`</span></span>\"</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">then</span> </pre></td></tr><tr><td data-num=\"10\"></td><td><pre>\t<span class=\"token builtin class-name\">umask</span> 002 </pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token keyword\">else</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>\t<span class=\"token builtin class-name\">umask</span> 022 </pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token keyword\">fi</span></pre></td></tr></table></figure><h4 id=\"etcdefaultuseradd\"><a class=\"markdownIt-Anchor\" href=\"#etcdefaultuseradd\">#</a> /etc/default/useradd</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/default/useradd </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#如果创建用户不创建同名组，默认会将该用户加入 GID 为 100 的系统组中（users） </span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token assign-left variable\">GROUP</span><span class=\"token operator\">=</span><span class=\"token number\">100</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ps:如果login.defs文件中的USERGROUPS_ENAB yes是no，该行配置才会生效</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#指定用户默认创建家目录的位置 </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token assign-left variable\"><span class=\"token environment constant\">HOME</span></span><span class=\"token operator\">=</span>/home </pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#用户账户停权 -1 永远不过期 </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token assign-left variable\">INACTIVE</span><span class=\"token operator\">=</span>-1 </pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#账号终止时间的设置，不设置不终止 </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token assign-left variable\">EXPIRE</span><span class=\"token operator\">=</span> </pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token comment\">#用户默认创建登录 shell </span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token assign-left variable\"><span class=\"token environment constant\">SHELL</span></span><span class=\"token operator\">=</span>/bin/bash </pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token comment\">#该目录下存放的是，用户的环境变量初始配置文件 </span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token assign-left variable\">SKEL</span><span class=\"token operator\">=</span>/etc/skel </pre></td></tr><tr><td data-num=\"22\"></td><td><pre></pre></td></tr><tr><td data-num=\"23\"></td><td><pre><span class=\"token comment\">#创建用户的同时，创建该用户的邮箱文件 </span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token assign-left variable\">CREATE_MAIL_SPOOL</span><span class=\"token operator\">=</span>yes</pre></td></tr></table></figure><p>用户创建的流程</p>\n<ul>\n<li>\n<p>1. 执行 <code>useradd</code>  命令 + 用户名</p>\n</li>\n<li>\n<p>2. 查看执行命令是否有选项</p>\n</li>\n<li>\n<p>3. 读取 <code>/etc/login.defs</code>  文件</p>\n</li>\n<li>\n<p>4. 读取 <code>/etc/default/useradd</code>  文件</p>\n</li>\n<li>\n<p>5. 如果没有 - M 则创建家目录</p>\n</li>\n<li>\n<p>6. 根据配置文件中的  <code>SKEL=/etc/skel</code>  将 <code>skel</code>  下面的环境变量文件拷贝到家目录下</p>\n</li>\n<li>\n<p>7. 用户信息记录到 <code>/etc/passwd</code>  文件中</p>\n</li>\n<li>\n<p>8. 用户密码信息记录到 <code>/etc/shadow</code>  文件中</p>\n</li>\n<li>\n<p>9. 用户组信息记录到 <code>/etc/group</code>  文件中</p>\n</li>\n<li>\n<p>10. 用户组密码信息记录到 <code>/etc/gshadow</code>  文件中</p>\n</li>\n</ul>\n<h2 id=\"用户的密码管理\"><a class=\"markdownIt-Anchor\" href=\"#用户的密码管理\">#</a> 用户的密码管理</h2>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>passwd：给用户设置密码 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">#语法：</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token function\">passwd</span> <span class=\"token punctuation\">[</span>用户名<span class=\"token punctuation\">]</span> </pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>ps:如果不加用户名，则修改当前登录用户的密码，只有root用户能在passwd命令后加用户名</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">#修改其他用户密码 </span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># passwd python </span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#修改 zls 用户的密码 </span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>Changing password <span class=\"token keyword\">for</span> user python. </pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token comment\">#新密码 </span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>New password: </pre></td></tr><tr><td data-num=\"16\"></td><td><pre>BAD PASSWORD: The password is a palindrome </pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token comment\">#重复新密码 </span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>Retype new password: </pre></td></tr><tr><td data-num=\"20\"></td><td><pre></pre></td></tr><tr><td data-num=\"21\"></td><td><pre><span class=\"token comment\">#所有认证令牌更新成功 </span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>passwd: all authentication tokens updated successfully.</pre></td></tr></table></figure><h4 id=\"免交互方式\"><a class=\"markdownIt-Anchor\" href=\"#免交互方式\">#</a> 免交互方式</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>stdin：标准输入 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>stdout：标准输出 </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>stderr：错误输出</pre></td></tr><tr><td data-num=\"4\"></td><td><pre></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo 'python' | passwd --stdin python</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>Changing password <span class=\"token keyword\">for</span> user python.</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>passwd: all authentication tokens updated successfully.</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token comment\">#脚本创建 100 个用户</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token function\">vim</span> creat_user</pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token comment\">#!/bin/bash</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token keyword\">for</span> <span class=\"token for-or-select variable\">i</span> <span class=\"token keyword\">in</span> <span class=\"token variable\"><span class=\"token variable\">`</span><span class=\"token function\">seq</span> <span class=\"token parameter variable\">-w</span> <span class=\"token number\">10</span><span class=\"token variable\">`</span></span><span class=\"token punctuation\">;</span><span class=\"token keyword\">do</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>  <span class=\"token function\">useradd</span> roger<span class=\"token variable\">$i</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'123'</span> <span class=\"token operator\">|</span> <span class=\"token function\">passwd</span> <span class=\"token parameter variable\">--stdin</span> roger<span class=\"token variable\">$i</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre><span class=\"token keyword\">done</span></pre></td></tr></table></figure><h4 id=\"随机密码生成\"><a class=\"markdownIt-Anchor\" href=\"#随机密码生成\">#</a> 随机密码生成</h4>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>tee：管道命令 </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>-a：append 追加 </pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre><span class=\"token punctuation\">[</span>root@localhost ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo $RANDOM | tee -a /tmp/pass.txt | passwd --stdin roger001</span></pre></td></tr></table></figure>",
            "tags": [
                "用户"
            ]
        }
    ]
}